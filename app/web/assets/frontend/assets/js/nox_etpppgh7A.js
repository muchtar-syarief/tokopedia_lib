import{r as p,j as b,b as i,k as A,C as S,F as x,R as E,_ as I}from"./nox_pyXA7rrAA.js";import{a as L,u as v}from"./nox_hAototeho.js";import{c as D}from"./nox_pegAkepte.js";import{D as T}from"./nox_oA7ptQppr.js";import{R as M}from"./nox_preegAooh.js";function N(t){const f=(a,r,s)=>{s.children?s.children.forEach(o=>f(a,[...r,s.id],o)):a.push([...r,s.id])},l=[];return t==null||t.forEach(a=>f(l,[],a)),l}const P=D(t=>{const{sender:f}=L(),{sender:l}=L();return{list:[],pendingInitEffect:!1,initEffect:(a,r,s)=>{t({pendingInitEffect:!0,list:[]}),f({method:"get",path:"legacy/v1/product/category",params:{is_public:!1,marketplace:"shopee",namespace:a,kota:"",pmax:0,pmin:0}},{signal:s,onError:()=>{t(o=>({...o,pendingInitEffect:!1}))},onSuccess:o=>{if(o){if(!o.length){t({pendingInitEffect:!1,list:[]});return}const y=o.map(n=>({productCount:n.count,shopeeCategoryId:n._id,shopeeCategoryName:n.name,tokopediaCategoryIds:[]}));t(n=>({...n,pendingInitEffect:!1,list:y})),l({method:"get",path:"tokopedia/mapper/map",params:{collection:a}},{signal:s,onSuccess(n){var c;if(r){const C=N((c=r.data.categoryAllListLite)==null?void 0:c.categories);n.data.forEach(m=>{C.forEach(d=>{d.indexOf(m.tokopedia_id)>-1&&t(g=>({...g,list:g.list.map(h=>(h.shopeeCategoryId===m.shopee_id&&(h.tokopediaCategoryIds=d),h))}))})})}}})}}})},updateSingleList:(a,r)=>{t(s=>({...s,list:s.list.map(o=>o.shopeeCategoryId==a?{...o,...r}:o)}))},reset:()=>t({list:[],pendingInitEffect:!1})}}),F=E.lazy(()=>I(()=>import("./nox_QQeyXhy7X.js"),["./nox_QQeyXhy7X.js","./nox_pyXA7rrAA.js","..\\css\\nox_reyeAA7Qp.css","./nox_hAototeho.js","./nox_Qp7rpthge.js","./nox_yp7yprhk7.js","./nox_Ap7oAXApA.js","./nox_hkyyy7koe.js","./nox_7XQAprAhh.js","./nox_geheotXAh.js","./nox_oA7ptQppr.js","./nox_gXhygXpee.js","./nox_ogAoghAQ7.js","./nox_gorQoh7AA.js"],import.meta.url)),V=E.lazy(()=>I(()=>import("./nox_kyehhytgA.js"),["./nox_kyehhytgA.js","./nox_pyXA7rrAA.js","..\\css\\nox_reyeAA7Qp.css","./nox_hAototeho.js","./nox_Qp7rpthge.js","./nox_yp7yprhk7.js","./nox_Ap7oAXApA.js","./nox_hkyyy7koe.js","./nox_7XQAprAhh.js","./nox_rtyoeAyo7.js","./nox_hgeAQoQoA.js","./nox_eAoyogQ7X.js","./nox_AX77QyXto.js","./nox_ogAoghAQ7.js","./nox_opgr7ehhQ.js"],import.meta.url)),w=E.lazy(()=>I(()=>import("./nox_77ggoreky.js"),["./nox_77ggoreky.js","./nox_pyXA7rrAA.js","..\\css\\nox_reyeAA7Qp.css","./nox_7yekg7gtQ.js","./nox_yp7yprhk7.js","./nox_hgeAQoQoA.js","./nox_hAototeho.js","./nox_hkyyy7koe.js","./nox_e7otkQypX.js","./nox_gorQoh7AA.js","./nox_Qp7rpthge.js","./nox_Ap7oAXApA.js","./nox_7XQAprAhh.js","./nox_QopAttkgQ.js","./nox_Qgghop7QX.js"],import.meta.url));function G(t){const[f,l]=p.useState(!1),[a,r,s,o,y]=P(e=>[e.list,e.initEffect,e.updateSingleList,e.pendingInitEffect,e.reset]),{sender:n,response:c}=v(),{sender:C,response:m}=v(),[d,g]=p.useState(null);p.useEffect(()=>(n({method:"get",path:"tokopedia/category/list"},{onSuccess:e=>{e||l(!0)}}),C({method:"get",path:"legacy/v1/product/namespace_all"},{onSuccess(e){e==null||e.forEach(u=>{u.name!=="default"&&g(u.name)})}}),()=>y()),[]),p.useEffect(()=>{d&&t.activePage=="category_map"&&r(d,c)},[d,c]);const h=p.useMemo(()=>m?m.map(e=>({label:e.name,value:e.name})):[],[m]),R=()=>{var e;if(c){const u=_=>{const k={label:_.name,value:_.id};return _.children&&(k.children=_.children.map(u)),k};return((e=c.data.categoryAllListLite)==null?void 0:e.categories.map(u))||[]}return[]};return b(x,{children:[i(p.Suspense,{fallback:i(A,{}),children:i(F,{onFinish:()=>l(!1),open:f,onCancel:()=>l(!1)})}),i(p.Suspense,{fallback:i(S,{loading:!0}),children:i(V,{list:a,namespace:d,namespaces:h,onChangeNamespace:g,initEffect:r,listCategoryTokopedia:c})}),i(T,{dashed:!0,style:{marginBlock:"5px"}}),!o&&a.length==0?i(M,{status:"404",title:"Data not found!"}):i("div",{style:{display:"grid",gridTemplateColumns:"1fr ",gap:"12px"},children:a.map(e=>i(p.Suspense,{fallback:i(S,{loading:!0}),children:i(w,{categoriesName:e.shopeeCategoryName,productCount:e.productCount,catsValue:e.tokopediaCategoryIds,onChangeCatsValue:u=>{s(e.shopeeCategoryId,{tokopediaCategoryIds:u})},optionsCats:R()},e.shopeeCategoryId)},e.shopeeCategoryId))})]})}export{G as default};
