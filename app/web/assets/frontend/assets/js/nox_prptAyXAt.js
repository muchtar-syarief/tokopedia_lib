import{r as p,j as s,F as S,f as I,R as E,_ as y}from"./nox_tAhhAtXeX.js";import{u as k,a as j}from"./nox_ooehoyXAo.js";import{c as L,R}from"./nox_phyXpQe7y.js";import{D as v}from"./nox_erepkrAgg.js";function A(o){const l=(i,n,t)=>{t.children?t.children.forEach(r=>l(i,[...n,t.id],r)):i.push([...n,t.id])},c=[];return o==null||o.forEach(i=>l(c,[],i)),c}const b=L(o=>{const{sender:l}=k(),{sender:c}=k();return{list:[],pendingInitEffect:!1,initEffect:(i,n)=>{o(t=>({...t,pendingInitEffect:!0,list:[]})),l({method:"get",path:"v1/product/category",params:{is_public:!1,marketplace:"shopee",namespace:i}},{onError:()=>{o(t=>({...t,pendingInitEffect:!1}))},onSuccess:t=>{if(t){t.length||o(a=>({...a,pendingInitEffect:!1,list:[]}));const r=t.map(a=>({productCount:a.count,shopeeCategoryId:a._id,shopeeCategoryName:a.name,tokopediaCategoryIds:[]}));o(a=>({...a,pendingInitEffect:!1,list:r})),c({method:"get",path:"tokopedia/mapper/map",params:{collection:i}},{onSuccess(a){var h;if(n){const f=A((h=n.data.categoryAllListLite)==null?void 0:h.categories);a.data.forEach(d=>{f.forEach(m=>{m.indexOf(d.tokopedia_id)>-1&&o(_=>({..._,list:_.list.map(g=>(g.shopeeCategoryId===d.shopee_id&&(g.tokopediaCategoryIds=m),g))}))})})}}})}}})},updateSingleList:(i,n)=>{o(t=>({...t,list:t.list.map(r=>r.shopeeCategoryId==i?{...r,...n}:r)}))}}}),D=E.lazy(()=>y(()=>import("./nox_XeXQkrXpe.js"),["./nox_XeXQkrXpe.js","./nox_tAhhAtXeX.js","..\\css\\nox_ytgrrphoy.css","./nox_ooehoyXAo.js","./nox_kthheoytQ.js","./nox_heeAgQ7ty.js","./nox_Xyrhpp7Xp.js","./nox_ghoQrkkAh.js","./nox_ggQyAhooe.js","./nox_rA7Ayr7yh.js","./nox_tykt7htyg.js","./nox_kehQtgQQp.js","./nox_QgrooAkh7.js","./nox_erepkrAgg.js"],import.meta.url)),T=E.lazy(()=>y(()=>import("./nox_XXrAXeQyQ.js"),["./nox_XXrAXeQyQ.js","./nox_tAhhAtXeX.js","..\\css\\nox_ytgrrphoy.css","./nox_ooehoyXAo.js","./nox_rA7Ayr7yh.js","./nox_Xyrhpp7Xp.js","./nox_tykt7htyg.js","./nox_kehQtgQQp.js","./nox_ghoQrkkAh.js","./nox_QQgrkpegX.js","./nox_hrtgpoerX.js","./nox_eQQAeekyr.js","./nox_eX7yrQyQk.js","./nox_heeAgQ7ty.js","./nox_kXre7gpep.js"],import.meta.url)),M=E.lazy(()=>y(()=>import("./nox_ktkr7ohQX.js"),["./nox_ktkr7ohQX.js","./nox_tAhhAtXeX.js","..\\css\\nox_ytgrrphoy.css","./nox_Xyrhpp7Xp.js","./nox_hrtgpoerX.js","./nox_ooehoyXAo.js","./nox_kehQtgQQp.js","./nox_y7QeXgeXt.js","./nox_ggQyAhooe.js","./nox_rA7Ayr7yh.js","./nox_tykt7htyg.js","./nox_ghoQrkkAh.js","./nox_QgQQ7h7Ap.js"],import.meta.url));function w(){const[o,l]=p.useState(!1),[c,i,n,t]=b(e=>[e.list,e.initEffect,e.updateSingleList,e.pendingInitEffect]),{sender:r,response:a}=j(),{sender:h,response:f}=j(),[d,m]=p.useState(null);p.useEffect(()=>{r({method:"get",path:"tokopedia/category/list"},{onSuccess:e=>{e||l(!0)}}),h({method:"get",path:"v1/product/namespace_all"},{onSuccess(e){e==null||e.forEach(u=>{u.name!=="default"&&m(u.name)})}})},[]),p.useEffect(()=>{d&&i(d,a)},[d]);const _=p.useMemo(()=>f?f.map(e=>({label:e.name,value:e.name})):[],[f]),g=()=>{var e;if(a){const u=C=>{const x={label:C.name,value:C.id};return C.children&&(x.children=C.children.map(u)),x};return((e=a.data.categoryAllListLite)==null?void 0:e.categories.map(u))||[]}return[]};return s.jsxs(S,{children:[s.jsx(p.Suspense,{fallback:s.jsx(s.Fragment,{}),children:s.jsx(D,{onFinish:()=>l(!1),open:o,onCancel:()=>l(!1)})}),s.jsx(p.Suspense,{fallback:s.jsx(I,{loading:!0}),children:s.jsx(T,{list:c,namespace:d,namespaces:_,onChangeNamespace:m,initEffect:i,listCategoryTokopedia:a})}),s.jsx(v,{dashed:!0,style:{marginBlock:"5px"}}),!t&&c.length==0?s.jsx(R,{status:"404",title:"Data not found!"}):s.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr ",gap:"12px"},children:c.map(e=>s.jsx(p.Suspense,{fallback:s.jsx(I,{loading:!0}),children:s.jsx(M,{categoriesName:e.shopeeCategoryName,productCount:e.productCount,catsValue:e.tokopediaCategoryIds,onChangeCatsValue:u=>{n(e.shopeeCategoryId,{tokopediaCategoryIds:u})},optionsCats:g()},e.shopeeCategoryId)},e.shopeeCategoryId))})]})}export{w as default};
