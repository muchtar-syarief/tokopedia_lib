import{r as p,j as b,b as i,k as A,C as S,F as x,R as E,_ as I}from"./nox_AXrk7pAAg.js";import{a as L,u as v}from"./nox_keQXrrQk7.js";import{c as D}from"./nox_pryy7t7oh.js";import{D as T}from"./nox_A7otpeApk.js";import{R as M}from"./nox_ygk7XQorh.js";function N(t){const f=(a,r,s)=>{s.children?s.children.forEach(o=>f(a,[...r,s.id],o)):a.push([...r,s.id])},l=[];return t==null||t.forEach(a=>f(l,[],a)),l}const P=D(t=>{const{sender:f}=L(),{sender:l}=L();return{list:[],pendingInitEffect:!1,initEffect:(a,r,s)=>{t({pendingInitEffect:!0,list:[]}),f({method:"get",path:"v1/product/category",params:{is_public:!1,marketplace:"shopee",namespace:a,kota:"",pmax:0,pmin:0}},{signal:s,onError:()=>{t(o=>({...o,pendingInitEffect:!1}))},onSuccess:o=>{if(o){if(!o.length){t({pendingInitEffect:!1,list:[]});return}const C=o.map(n=>({productCount:n.count,shopeeCategoryId:n._id,shopeeCategoryName:n.name,tokopediaCategoryIds:[]}));t(n=>({...n,pendingInitEffect:!1,list:C})),l({method:"get",path:"tokopedia/mapper/map",params:{collection:a}},{signal:s,onSuccess(n){var c;if(r){const y=N((c=r.data.categoryAllListLite)==null?void 0:c.categories);n.data.forEach(m=>{y.forEach(d=>{d.indexOf(m.tokopedia_id)>-1&&t(g=>({...g,list:g.list.map(h=>(h.shopeeCategoryId===m.shopee_id&&(h.tokopediaCategoryIds=d),h))}))})})}}})}}})},updateSingleList:(a,r)=>{t(s=>({...s,list:s.list.map(o=>o.shopeeCategoryId==a?{...o,...r}:o)}))},reset:()=>t({list:[],pendingInitEffect:!1})}}),F=E.lazy(()=>I(()=>import("./nox_QykyeQQpk.js"),["./nox_QykyeQQpk.js","./nox_AXrk7pAAg.js","..\\css\\nox_hQykrXApQ.css","./nox_keQXrrQk7.js","./nox_yQyr7gtQQ.js","./nox_XeXrkhXto.js","./nox_totephpAo.js","./nox_rrApg7otr.js","./nox_ygteAoehA.js","./nox_AryetQtX7.js","./nox_A7otpeApk.js","./nox_opppAgQ77.js","./nox_gykoyX7Qo.js","./nox_7eQtgQktA.js"],import.meta.url)),V=E.lazy(()=>I(()=>import("./nox_tkpXykAtk.js"),["./nox_tkpXykAtk.js","./nox_AXrk7pAAg.js","..\\css\\nox_hQykrXApQ.css","./nox_keQXrrQk7.js","./nox_yQyr7gtQQ.js","./nox_XeXrkhXto.js","./nox_totephpAo.js","./nox_rrApg7otr.js","./nox_ygteAoehA.js","./nox_yy7XpyyXt.js","./nox_grrpgX7tQ.js","./nox_AQgpygrte.js","./nox_h7Ayrgh7o.js","./nox_gykoyX7Qo.js","./nox_QXhyotpyh.js"],import.meta.url)),w=E.lazy(()=>I(()=>import("./nox_rXtXQeeQe.js"),["./nox_rXtXQeeQe.js","./nox_AXrk7pAAg.js","..\\css\\nox_hQykrXApQ.css","./nox_yoQeAgeoy.js","./nox_XeXrkhXto.js","./nox_grrpgX7tQ.js","./nox_keQXrrQk7.js","./nox_rrApg7otr.js","./nox_hohtr7hty.js","./nox_7eQtgQktA.js","./nox_yQyr7gtQQ.js","./nox_totephpAo.js","./nox_ygteAoehA.js","./nox_poeyekroA.js","./nox_gky7rtkyr.js"],import.meta.url));function G(t){const[f,l]=p.useState(!1),[a,r,s,o,C]=P(e=>[e.list,e.initEffect,e.updateSingleList,e.pendingInitEffect,e.reset]),{sender:n,response:c}=v(),{sender:y,response:m}=v(),[d,g]=p.useState(null);p.useEffect(()=>(n({method:"get",path:"tokopedia/category/list"},{onSuccess:e=>{e||l(!0)}}),y({method:"get",path:"v1/product/namespace_all"},{onSuccess(e){e==null||e.forEach(u=>{u.name!=="default"&&g(u.name)})}}),()=>C()),[]),p.useEffect(()=>{d&&t.activePage=="category_map"&&r(d,c)},[d,c]);const h=p.useMemo(()=>m?m.map(e=>({label:e.name,value:e.name})):[],[m]),R=()=>{var e;if(c){const u=_=>{const k={label:_.name,value:_.id};return _.children&&(k.children=_.children.map(u)),k};return((e=c.data.categoryAllListLite)==null?void 0:e.categories.map(u))||[]}return[]};return b(x,{children:[i(p.Suspense,{fallback:i(A,{}),children:i(F,{onFinish:()=>l(!1),open:f,onCancel:()=>l(!1)})}),i(p.Suspense,{fallback:i(S,{loading:!0}),children:i(V,{list:a,namespace:d,namespaces:h,onChangeNamespace:g,initEffect:r,listCategoryTokopedia:c})}),i(T,{dashed:!0,style:{marginBlock:"5px"}}),!o&&a.length==0?i(M,{status:"404",title:"Data not found!"}):i("div",{style:{display:"grid",gridTemplateColumns:"1fr ",gap:"12px"},children:a.map(e=>i(p.Suspense,{fallback:i(S,{loading:!0}),children:i(w,{categoriesName:e.shopeeCategoryName,productCount:e.productCount,catsValue:e.tokopediaCategoryIds,onChangeCatsValue:u=>{s(e.shopeeCategoryId,{tokopediaCategoryIds:u})},optionsCats:R()},e.shopeeCategoryId)},e.shopeeCategoryId))})]})}export{G as default};
